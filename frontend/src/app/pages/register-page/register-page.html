<section id="register-section">
  <div id="title-section">
    <div id="title-div">
      <h1>Create a new account for free.</h1>
    </div>
  </div>

  <div id="register-content">
    <form #RegisterForm="ngForm" (ngSubmit)="RegisterAttempt()">
      <label for="username">Username</label>
      <input
        (input)="clearMessages(); clearFieldError('username')"
        type="text"
        name="username"
        id="username"
        placeholder="How you want to be addressed"
        required
        [maxlength]="20"
        [minlength]="3"
        [(ngModel)]="formData.username"
        #usernameControl="ngModel"
      />

      <div
        class="error-message"
        *ngIf="usernameControl.touched && usernameControl.hasError('minlength')"
      >
        The user name must be at least 3 characters long.
      </div>
      <div
        class="error-message"
        *ngIf="usernameControl.touched && usernameControl.hasError('maxlength')"
      >
        The user name must not exceed 20 characters.
      </div>

      <div class="error-message" *ngIf="usernameBackendError()">
        {{ usernameBackendError() }}
      </div>

      <div class="error-message" *ngIf="fieldErrors().username">
        {{ fieldErrors().username }}
      </div>

      <label for="email">Email</label>
      <input
        (input)="clearMessages(); clearFieldError('email')"
        type="email"
        name="email"
        id="email"
        placeholder="name@email.com"
        required
        [maxlength]="30"
        [(ngModel)]="formData.email"
        #emailControl="ngModel"
      />

      <div class="error-message" *ngIf="emailControl.touched && emailControl.hasError('maxlength')">
        The email must not exceed 30 characters.
      </div>

      <div class="error-message" *ngIf="emailBackendError()">
        {{ emailBackendError() }}
      </div>

      <div class="error-message" *ngIf="fieldErrors().email">
        {{ fieldErrors().email }}
      </div>

      <label for="password">Password</label>
      <input
        (input)="clearMessages(); clearFieldError('password')"
        type="password"
        name="password"
        id="password"
        placeholder="*********"
        required
        [maxlength]="20"
        [minlength]="8"
        [pattern]="passwordPattern"
        [(ngModel)]="formData.password"
        #passwordControl="ngModel"
      />

      <div
        class="error-message"
        *ngIf="passwordControl.touched && passwordControl.hasError('maxlength')"
      >
        Password cannot be longer than 20 characters.
      </div>
      <div
        class="error-message"
        *ngIf="passwordControl.touched && passwordControl.hasError('minlength')"
      >
        Password cannot be shorter than 8 characters.
      </div>
      <div
        class="error-message"
        *ngIf="passwordControl.touched && passwordControl.hasError('pattern')"
      >
        Password must contain at least one number.
      </div>

      <div class="error-message" *ngIf="fieldErrors().password">
        {{ fieldErrors().password }}
      </div>

      <label for="passwordAgain">Password Again</label>
      <input
        (input)="clearMessages(); clearFieldError('passwordAgain')"
        type="password"
        name="passwordAgain"
        id="passwordAgain"
        placeholder="*********"
        required
        [(ngModel)]="formData.passwordAgain"
        #passwordAgainControl="ngModel"
      />

      <div
        class="error-message"
        *ngIf="
          passwordControl.touched &&
          passwordAgainControl.touched &&
          passwordControl.value !== passwordAgainControl.value
        "
      >
        Passwords must match.
      </div>

      <div class="error-message" *ngIf="fieldErrors().passwordAgain">
        {{ fieldErrors().passwordAgain }}
      </div>

      <button
        type="submit"
        [disabled]="RegisterForm.invalid || passwordControl.value !== passwordAgainControl.value"
      >
        Register
      </button>

      <div class="error-message backend-error" *ngIf="backendError()">
        {{ backendError() }}
      </div>

      <div class="success-message" *ngIf="successMessage()">
        {{ successMessage() }}
      </div>
    </form>
  </div>
</section>
