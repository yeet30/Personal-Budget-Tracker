<div id="transactions-frame">
    <ul id="side-ul">
        <li>
            <a  class="side-button"
                [class.active]="selected_side() === 'income'" 
                (click)="setSide('income')"
                >INCOME
            </a>
        </li>
        <li>
            <a  class="side-button"
                [class.active]="selected_side() === 'expense'" 
                (click)="setSide('expense')"
                >EXPENSE
            </a>
        </li>
    </ul>

    <div class="card">
        <div id="transactions-content">
            <section id="income-section" *ngIf="(selected_side() === 'income')">
                <div id="income-inputs">
                    <h3>Please select an income type.</h3>
                    <p>Stable income means a certain amount of money will for sure be earned in each time period.</p>

                    <section class="income-part" id="stable-income-section">
                        <label for="income-categories">Stable income</label>
                        <select 
                        name="income-categories" 
                        id="income-categories"
                        required
                        [ngModel] = "income_category_id()"
                        (ngModelChange) = "income_category_id.set($event)"
                        [disabled]="loadingCategories()"
                        >
                            <option [ngValue]="null" disabled *ngIf="!loadingCategories()">Select a category</option>
                            <option *ngIf="loadingCategories()" disabled>Loading categories...</option>
                            <option *ngFor="let category of categories()" [ngValue]="category.category_id">
                                {{ category.name }}
                            </option>
                        </select>

                        <label for="income-amount">Amount of money</label>
                        <div class="money-input">
                            <span class="prefix">$</span>
                            <input 
                            id="income-amount" 
                            name="income-amount" 
                            type="number" 
                            placeholder="0.00"
                            required
                            [ngModel] = "income_amount()"
                            (ngModelChange) = "income_amount.set($event);"
                            >
                        </div>
                        <button type="button" (click)="addStableIncome()">Add</button>
                    </section>    
                    
                    <h3>Please select a savings type.</h3>
                    <p>Savings means a certain amount of money had been owned before, or can be added into the budget now.</p>
                    <section class="income-part" id="savings-section">
                        <label for="savings-categories">Savings</label>
                        <select 
                        name="savings-categories" 
                        id="savings-categories"
                        required
                        [ngModel] = "savings_category_id()"
                        (ngModelChange) = "savings_category_id.set($event)"
                        [disabled]="loadingCategories()"
                        >
                            <option [ngValue]="null" disabled *ngIf="!loadingCategories()">Select a category</option>
                            <option *ngIf="loadingCategories()" disabled>Loading categories...</option>
                            <option *ngFor="let category of categories()" [ngValue]="category.category_id">
                                {{ category.name }}
                            </option>
                        </select>
                        <label for="savings-amount">Amount of money</label>
                        <div class="money-input">
                            <span class="prefix">$</span>
                            <input
                            id="savings-amount" 
                            name="savings-amount" 
                            type="number" 
                            placeholder="0.00"
                            required
                            [ngModel] = "savings_amount()"
                            (ngModelChange) = "savings_amount.set($event);">
                        </div>
                        <button type="button" (click)="addSavings()">Add</button>
                    </section>
                    
                </div>
            </section>

            <section id="expense-section" *ngIf="(selected_side() === 'expense')">
                <div id="expense-inputs">
                    <h3>Please select an expense type.</h3>
                    <p>Fixed cost means a certain amount of money will for sure be spent in each time period.</p>

                    <section class="cost-part" id="fixed-cost-section">
                        <label for="cost-categories">Fixed cost</label>
                        <select 
                        name="cost-categories" 
                        id="cost-categories"
                        required
                        [ngModel] = "cost_category_id()"
                        (ngModelChange) = "cost_category_id.set($event)"
                        [disabled]="loadingCategories()"
                        >
                            <option [ngValue]="null" disabled *ngIf="!loadingCategories()">Select a category</option>
                            <option *ngIf="loadingCategories()" disabled>Loading categories...</option>
                            <option *ngFor="let category of categories()" [ngValue]="category.category_id">
                                {{ category.name }}
                            </option>
                        </select>

                        <label for="cost-amount">Amount of money</label>
                        <div class="money-input">
                            <span class="prefix">$</span>
                            <input 
                            id="cost-amount" 
                            name="cost-amount" 
                            type="number" 
                            placeholder="0.00"
                            required
                            [ngModel] = "cost_amount()"
                            (ngModelChange) = "cost_amount.set($event);"
                            >
                        </div>
                        <button type="button" (click)="addFixedCost()">Add</button>
                    </section>
                    
                    <h3>Please select a leisure type.</h3>
                    <p>Leisure means a certain amount of money that was spent from the budget.</p>
                    <section class="cost-part" id="leisure-section">
                        <label for="leisure-categories">Leisure</label>
                        <select 
                        name="leisure-categories" 
                        id="leisure-categories"
                        required
                        [ngModel] = "leisure_category_id()"
                        (ngModelChange) = "leisure_category_id.set($event)"
                        [disabled]="loadingCategories()"
                        >
                            <option [ngValue]="null" disabled *ngIf="!loadingCategories()">Select a category</option>
                            <option *ngIf="loadingCategories()" disabled>Loading categories...</option>
                            <option *ngFor="let category of categories()" [ngValue]="category.category_id">
                                {{ category.name }}
                            </option>
                        </select>
                        <label for="leisure-amount">Amount of money</label>
                        <div class="money-input">
                            <span class="prefix">$</span>
                            <input
                            id="leisure-amount" 
                            name="leisure-amount" 
                            type="number" 
                            placeholder="0.00"
                            required
                            [ngModel] = "leisure_amount()"
                            (ngModelChange) = "leisure_amount.set($event);">
                        </div>
                        <button type="button" (click)="addLeisure()">Add</button>
                    </section>
                    
                </div>
            </section>

            <div id="display-section">
                    <span id="header-span"><h3>Recent Transactions</h3></span>
                    <div *ngIf="savedTransactions().length === 0" class="no-transactions">No saved transactions yet.</div>
                    <div *ngIf="savedTransactions().length > 0" class="saved-transactions-table">
                        <div class="transaction-header">
                            <span>Date</span>
                            <span>Category</span>
                            <span>Type</span>
                            <span>Amount</span>
                        </div>
                        <div class="transaction-row" *ngFor="let t of savedTransactions().slice(0, 10)">
                            <span>{{ t.date }}</span>
                            <span>{{ t.category_name }}</span>
                            <span [class]="t.type.toLowerCase()">{{ t.type }}</span>
                            <span [class]="t.type === 'INCOME' ? 'income-amount' : 'expense-amount'">
                                {{ t.type === 'INCOME' ? '+' : '-' }}{{ t.amount }} {{ t.currency }}
                            </span>
                        </div>
                    </div>
                    
                    <h3>Current Session</h3>
                    <ul>
                        <li *ngFor="let t of transaction_array().slice().reverse()">
                            <span *ngIf="t.amount > 0" class="income-amount-span">+ $ {{t.amount}}</span>
                            <span *ngIf="t.amount < 0" class="cost-amount-span">- $ {{t.amount*-1}}</span>
                            <span class="info-span">from {{t.type}}</span>
                        </li>
                    </ul>
                    <div id="total-operation">
                        <span id="total-span">+ Total</span>
                        <span id="total-line"></span>
                        <span id="total-amount">$ {{total_amount()}}</span>
                    </div>
                </div>
            </div>
        </div>
</div>
